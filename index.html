<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>NML ‚Äî NIS Media League</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
  <style>
    /* ============================================================
       TEAM LOGOS & ROSTERS
       ============================================================ */
    .team-logo-sm { width:22px;height:22px;object-fit:contain;border-radius:4px;margin-right:7px;vertical-align:middle;flex-shrink:0; }
    .team-logo-placeholder-sm { display:inline-flex;align-items:center;justify-content:center;width:22px;height:22px;border-radius:4px;background:rgba(255,255,255,.08);font-size:11px;margin-right:7px;vertical-align:middle;flex-shrink:0; }
    .col-team { cursor:pointer; }
    .col-team:hover .team-cell-name { text-decoration:underline; text-underline-offset:3px; }
    .team-cell { display:flex;align-items:center; }
    .team-cell-name { flex:1; }

    /* --- Team Modal --- */
    .modal-overlay-team { position:fixed;inset:0;background:rgba(0,0,0,.72);display:flex;align-items:center;justify-content:center;z-index:200;padding:16px;backdrop-filter:blur(4px); }
    .modal-overlay-team[hidden] { display:none !important; }
    .modal-overlay[hidden]      { display:none !important; }
    .team-modal-box { background:var(--bg-card,#121318);border-radius:16px;width:100%;max-width:560px;max-height:85vh;display:flex;flex-direction:column;box-shadow:0 32px 80px rgba(0,0,0,.6);overflow:hidden;border:1px solid rgba(255,255,255,.08); }
    .team-modal-header { display:flex;align-items:center;gap:16px;padding:24px 24px 18px;border-bottom:1px solid rgba(255,255,255,.08);position:relative; }
    .team-logo-wrap { display:flex;flex-direction:column;align-items:center;gap:6px;flex-shrink:0; }
    .team-logo-lg { width:72px;height:72px;object-fit:contain;border-radius:10px;background:rgba(255,255,255,.06); }
    .logo-placeholder-lg { width:72px;height:72px;border-radius:10px;background:rgba(255,255,255,.06);display:flex;align-items:center;justify-content:center;font-size:28px;border:2px dashed rgba(255,255,255,.15); }
    .logo-upload-btn { font-size:.72rem;padding:3px 9px;border-radius:6px;border:1px solid rgba(255,255,255,.2);background:transparent;color:rgba(255,255,255,.6);cursor:pointer;white-space:nowrap;display:none;transition:all .15s; }
    .admin-mode .logo-upload-btn { display:inline-block; }
    .logo-upload-btn:hover { background:rgba(255,255,255,.1);color:#fff; }
    .team-modal-info { flex:1;min-width:0; }
    .team-modal-info h3 { margin:0 0 4px;font-size:1.3rem; }
    .team-modal-meta { font-size:.82rem;opacity:.6;display:flex;flex-wrap:wrap;gap:12px;margin:0; }
    .team-modal-close { position:absolute;right:16px;top:16px;background:rgba(255,255,255,.08);border:none;border-radius:50%;width:32px;height:32px;display:flex;align-items:center;justify-content:center;cursor:pointer;color:#fff;font-size:1rem;transition:background .15s; }
    .team-modal-close:hover { background:rgba(255,255,255,.16); }
    .team-modal-body { flex:1;overflow-y:auto;padding:16px 24px 24px; }
    .roster-section-head { display:flex;align-items:center;justify-content:space-between;margin-bottom:12px; }
    .roster-section-head h4 { margin:0;font-size:.95rem;opacity:.7;text-transform:uppercase;letter-spacing:.06em; }
    .btn-add-player { font-size:.78rem;padding:5px 12px;border-radius:8px;background:var(--accent,#f5c400);color:#08090d;border:none;cursor:pointer;display:none;transition:opacity .15s;font-weight:700; }
    .admin-mode .btn-add-player { display:inline-block; }
    .btn-add-player:hover { opacity:.85; }

    /* ‚îÄ‚îÄ Add Player Form (no rating) ‚îÄ‚îÄ */
    .add-player-form { display:none;gap:8px;flex-wrap:wrap;margin-bottom:12px;background:rgba(255,255,255,.04);padding:12px;border-radius:10px; }
    .add-player-form.visible { display:flex; }
    .add-player-form input { padding:7px 10px;border-radius:7px;border:1px solid rgba(255,255,255,.15);background:rgba(255,255,255,.06);color:#fff;font-size:.88rem; }
    .add-player-form input:focus { outline:none;border-color:var(--accent,#f5c400); }
    .add-player-form .inp-num  { width:62px; }
    .add-player-form .inp-name { flex:1;min-width:110px; }
    .add-player-form .form-btns { display:flex;gap:6px; }

    /* ‚îÄ‚îÄ Player Item ‚îÄ‚îÄ */
    .player-item { display:flex;align-items:center;gap:10px;padding:9px 12px;border-radius:9px;background:rgba(255,255,255,.04);margin-bottom:5px;transition:background .12s; }
    .player-item:hover { background:rgba(255,255,255,.07); }
    .player-num  { font-weight:700;font-size:.88rem;min-width:28px;text-align:center;opacity:.5; }
    .player-name { flex:1;font-weight:500;font-size:.93rem; }
    .player-goals-badge      { background:var(--accent,#f5c400);color:#08090d;padding:2px 9px;border-radius:12px;font-size:.74rem;font-weight:700; }
    .player-goals-badge.zero { background:rgba(255,255,255,.12); }
    .btn-remove-player { background:none;border:none;color:#ff6b6b;cursor:pointer;font-size:1rem;padding:2px 4px;border-radius:4px;display:none;opacity:.7;transition:opacity .12s; }
    .admin-mode .btn-remove-player { display:inline; }
    .btn-remove-player:hover { opacity:1; }
    .no-players-msg { text-align:center;padding:24px;opacity:.4;font-size:.88rem; }

    /* ============================================================
       MATCH MODAL ‚Äî GOAL ENTRY (admin) & VIEW (non-admin)
       ============================================================ */

    /* Goal entry section */
    .goal-entry-section { margin-top:16px;border-top:1px solid rgba(255,255,255,.1);padding-top:14px; }
    .ge-header { font-size:.82rem;font-weight:700;text-transform:uppercase;letter-spacing:.07em;opacity:.55;margin-bottom:10px; }
    .ge-form-row { display:flex;flex-wrap:wrap;gap:7px;align-items:center;margin-bottom:12px;padding:10px 12px;background:rgba(255,255,255,.04);border-radius:10px; }
    .ge-minute { width:58px;padding:6px 8px;border-radius:7px;border:1px solid rgba(255,255,255,.15);background:rgba(255,255,255,.06);color:#fff;font-size:.85rem;text-align:center; }
    .ge-minute:focus { outline:none;border-color:var(--accent,#d4a017); }
    .ge-side-tabs { display:flex;gap:3px;flex-shrink:0; }
    .ge-side-tab  { padding:5px 10px;border-radius:7px;border:1px solid rgba(255,255,255,.15);background:rgba(255,255,255,.05);color:rgba(255,255,255,.6);font-size:.78rem;cursor:pointer;font-weight:600;transition:all .15s;max-width:100px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap; }
    .ge-side-tab.active { background:var(--accent,#d4a017);border-color:var(--accent,#d4a017);color:#0a0e1a; }
    .ge-select  { padding:6px 8px;border-radius:7px;border:1px solid rgba(255,255,255,.15);background:rgba(255,255,255,.06);color:#fff;font-size:.8rem;cursor:pointer;flex:1;min-width:100px; }
    .ge-select:focus { outline:none;border-color:var(--accent,#d4a017); }
    .ge-select option { background:#1a1a2e; }
    .ge-og-label { display:flex;align-items:center;gap:5px;font-size:.8rem;cursor:pointer;padding:5px 9px;border-radius:7px;background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.1);white-space:nowrap;color:rgba(255,255,255,.7);transition:all .15s; }
    .ge-og-label:hover { background:rgba(255,118,117,.1);border-color:rgba(255,118,117,.3);color:#ff7675; }

    /* Goal chips */
    .goals-chips { display:flex;flex-wrap:wrap;gap:5px;min-height:20px; }
    .goal-chip { display:inline-flex;align-items:center;gap:5px;background:rgba(255,255,255,.08);border-radius:16px;padding:4px 10px 4px 8px;font-size:.78rem;line-height:1.2; }
    .goal-chip-dot { width:7px;height:7px;border-radius:50%;flex-shrink:0; }
    .goal-chip-min { font-weight:700;opacity:.7; }
    .goal-chip-name { font-weight:600; }
    .goal-chip-assist { opacity:.6;font-size:.73rem; }
    .goal-chip-og { font-size:.7rem;font-weight:800;color:#ff7675;background:rgba(255,118,117,.15);padding:1px 5px;border-radius:8px;margin-left:2px; }
    .goal-chip-remove { background:none;border:none;color:#ff6b6b;cursor:pointer;padding:0;font-size:.95rem;line-height:1;margin-left:2px;opacity:.7;transition:opacity .12s; }
    .goal-chip-remove:hover { opacity:1; }
    .goals-empty-hint { font-size:.76rem;opacity:.35;font-style:italic; }

    /* Mismatch warning */
    .gs-mismatch-warn { font-size:.75rem;color:#fdcb6e;margin-top:8px;text-align:center;padding:6px 10px;background:rgba(253,203,110,.08);border-radius:7px; }

    /* ‚îÄ‚îÄ Non-admin readonly match view ‚îÄ‚îÄ */
    .view-match-header { text-align:center;margin-bottom:16px; }
    .view-match-score  { font-size:3rem;font-weight:900;color:var(--accent,#d4a017);line-height:1; }
    .view-match-teams  { display:flex;justify-content:space-between;font-size:.82rem;font-weight:600;opacity:.6;margin-top:6px; }
    .view-goals-list   { list-style:none;padding:0;margin:0; }
    .view-goal-row     { display:flex;align-items:center;gap:8px;padding:7px 10px;border-radius:8px;background:rgba(255,255,255,.04);margin-bottom:4px;font-size:.85rem; }
    .view-goal-row.away-goal { flex-direction:row-reverse; }
    .vg-dot  { width:8px;height:8px;border-radius:50%;flex-shrink:0; }
    .vg-min  { font-weight:700;opacity:.6;min-width:30px;font-size:.8rem; }
    .vg-name { font-weight:600;flex:1; }
    .vg-assist { opacity:.6;font-size:.78rem; }
    .vg-og-tag { font-size:.7rem;font-weight:800;color:#ff7675;background:rgba(255,118,117,.15);padding:2px 6px;border-radius:8px; }
    .view-no-goals { text-align:center;padding:16px;opacity:.4;font-size:.85rem; }
    .view-close-row { text-align:center;margin-top:16px; }

    /* ‚îÄ‚îÄ Match card goal count badge ‚îÄ‚îÄ */
    .match-goal-count { font-size:.68rem;font-weight:700;background:rgba(212,160,23,.2);color:var(--accent,#d4a017);border-radius:8px;padding:1px 6px;margin-left:4px; }

    /* ‚îÄ‚îÄ Players Tab ‚îÄ‚îÄ */
    .players-page { padding:0; }
    .players-tab-header { display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:10px;margin-bottom:20px; }
    .players-tab-header h2 { margin:0; }
    .team-filter-select { padding:8px 14px;border-radius:9px;border:1px solid rgba(255,255,255,.15);background:rgba(255,255,255,.06);color:#fff;font-size:.88rem;cursor:pointer;min-width:160px; }
    .team-filter-select:focus { outline:none; }
    .team-filter-select option { background:#1a1a2e; }
    .scorers-list { display:flex;flex-direction:column;gap:4px; }
    .scorer-row { display:flex;align-items:center;gap:12px;padding:11px 14px;border-radius:10px;background:rgba(255,255,255,.04);transition:background .12s; }
    .scorer-row:hover { background:rgba(255,255,255,.07); }
    .scorer-rank { font-weight:800;font-size:.95rem;min-width:28px;text-align:center;opacity:.5; }
    .scorer-rank.top { opacity:1;color:var(--accent,#d4a017); }
    .scorer-logo-sm { width:28px;height:28px;object-fit:contain;border-radius:5px;background:rgba(255,255,255,.06);flex-shrink:0; }
    .scorer-logo-placeholder { width:28px;height:28px;border-radius:5px;background:rgba(255,255,255,.08);display:flex;align-items:center;justify-content:center;font-size:13px;flex-shrink:0; }
    .scorer-info { flex:1;min-width:0; }
    .scorer-name { font-weight:600;font-size:.93rem; }
    .scorer-team-name { font-size:.78rem;opacity:.55; }
    .scorer-goals-col { display:flex;align-items:center;gap:5px; }
    .scorer-goals-num { font-size:1.2rem;font-weight:800;color:var(--accent,#d4a017);min-width:28px;text-align:center; }
    .scorer-goals-label { font-size:.75rem;opacity:.5; }
    .scorer-assists-col { font-size:.8rem;opacity:.6;min-width:40px;text-align:center; }
    /* ‚îÄ‚îÄ Players controls bar (sort + search) ‚îÄ‚îÄ */
    .players-controls {
      display: flex; flex-wrap: wrap;
      align-items: center; gap: 10px;
      margin-bottom: 16px;
    }
    .sort-bar {
      display: flex; flex-wrap: wrap;
      align-items: center; gap: 6px;
      flex: 1; min-width: 0;
    }
    .sort-label {
      font-size: .72rem; font-weight: 700;
      text-transform: uppercase; letter-spacing: .07em;
      color: rgba(255,255,255,.3);
      white-space: nowrap;
    }
    .sort-chip {
      padding: 6px 13px;
      border-radius: 20px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.04);
      color: rgba(255,255,255,.5);
      font-size: .78rem; font-weight: 700;
      cursor: pointer; transition: all .14s;
      white-space: nowrap;
    }
    .sort-chip:hover {
      background: rgba(255,255,255,.09);
      color: rgba(255,255,255,.85);
      border-color: rgba(255,255,255,.2);
    }
    .sort-chip.active {
      background: var(--accent,#f5c400);
      border-color: var(--accent,#f5c400);
      color: #08090d;
      box-shadow: 0 2px 10px rgba(245,196,0,.22);
    }
    /* ‚îÄ‚îÄ Player search ‚îÄ‚îÄ */
    .player-search-wrap {
      position: relative;
      display: flex; align-items: center;
      flex: 0 0 auto; width: 240px;
    }
    .search-icon {
      position: absolute; left: 11px;
      font-size: .85rem; pointer-events: none;
      opacity: .4;
    }
    .player-search-input {
      width: 100%;
      padding: 7px 32px 7px 32px;
      background: rgba(255,255,255,.05);
      border: 1px solid rgba(255,255,255,.12);
      border-radius: 20px;
      color: #fff; font-size: .82rem;
      outline: none; transition: border-color .14s;
    }
    .player-search-input:focus {
      border-color: var(--accent,#f5c400);
      background: rgba(255,255,255,.07);
    }
    .player-search-input::placeholder { color: rgba(255,255,255,.3); }
    .search-clear {
      position: absolute; right: 8px;
      background: none; border: none;
      color: rgba(255,255,255,.35); font-size: .85rem;
      cursor: pointer; padding: 2px 4px; line-height: 1;
      transition: color .12s;
    }
    .search-clear:hover { color: rgba(255,255,255,.7); }
    @media (max-width: 600px) {
      .players-controls { flex-direction: column; align-items: stretch; }
      .player-search-wrap { width: 100%; }
    }

    /* ‚îÄ‚îÄ Scorer row overhaul ‚îÄ‚îÄ */
    .scorer-row {
      display: flex; align-items: center; gap: 12px;
      padding: 11px 14px; border-radius: 10px;
      background: rgba(255,255,255,.04);
      transition: background .12s; margin-bottom: 4px;
    }
    .scorer-row:hover { background: rgba(255,255,255,.07); }
    .scorer-info { flex: 1; min-width: 0; }
    .scorer-name { font-weight: 600; font-size: .93rem; }
    .scorer-team-name { font-size: .75rem; opacity: .5; margin-top: 1px; }
    .player-num-tag {
      font-size: .75rem; font-weight: 500;
      opacity: .35; margin-left: 4px;
    }

    /* Secondary stats row inside scorer-info */
    .sec-stats-row {
      display: flex; gap: 8px; margin-top: 4px;
    }
    .sec-stat {
      font-size: .72rem; font-weight: 600;
      opacity: .45; white-space: nowrap;
    }

    /* Primary stat column (right side) */
    .scorer-primary-col {
      display: flex; flex-direction: column;
      align-items: center; flex-shrink: 0;
      min-width: 52px; text-align: center;
    }
    .primary-val {
      font-size: 1.25rem; font-weight: 900;
      color: var(--accent,#f5c400); line-height: 1.1;
    }
    .primary-label {
      font-size: .65rem; opacity: .45;
      text-transform: uppercase; letter-spacing: .05em;
      margin-top: 1px;
    }

    /* Rank */
    .scorer-rank { font-weight: 900; font-size: .9rem; min-width: 24px; text-align: center; opacity: .4; }
    .scorer-rank.top { opacity: 1; color: var(--accent,#f5c400); }

    .players-empty { text-align:center;padding:48px 16px;opacity:.4; }
    .players-empty .empty-icon { font-size:3rem;margin-bottom:12px; }
    .players-empty p { margin:0;font-size:.9rem; }

    /* ‚îÄ‚îÄ Admin team list logo ‚îÄ‚îÄ */
    .team-item { display:flex;align-items:center;gap:10px; }
    .team-item-logo    { width:30px;height:30px;object-fit:contain;border-radius:5px;cursor:pointer;flex-shrink:0; }
    .team-item-logo-ph { width:30px;height:30px;border-radius:5px;background:rgba(255,255,255,.06);border:1px dashed rgba(255,255,255,.2);display:flex;align-items:center;justify-content:center;font-size:13px;cursor:pointer;flex-shrink:0;transition:background .12s; }
    .team-item-logo-ph:hover { background:rgba(255,255,255,.12); }

    /* misc */
    .btn-sm-ghost  { background:none;border:1px solid rgba(255,255,255,.2);color:rgba(255,255,255,.7);padding:5px 10px;border-radius:7px;font-size:.8rem;cursor:pointer;transition:all .12s; }
    .btn-sm-ghost:hover  { background:rgba(255,255,255,.08);color:#fff; }
    .btn-sm-accent { background:var(--accent,#f5c400);border:none;color:#08090d;padding:6px 12px;border-radius:7px;font-size:.82rem;cursor:pointer;transition:opacity .12s;font-weight:700; }
    .btn-sm-accent:hover { opacity:.85; }

    /* ‚îÄ‚îÄ Team modal tab bar ‚îÄ‚îÄ */
    .tm-tab-bar {
      display: flex; align-items: center; gap: 4px;
      margin-bottom: 14px;
      padding-bottom: 12px;
      border-bottom: 1px solid rgba(255,255,255,.07);
    }
    .tm-tab-spacer { flex: 1; }
    .tm-tab-btn {
      padding: 6px 14px; border-radius: 8px;
      border: 1px solid rgba(255,255,255,.1);
      background: transparent;
      color: rgba(255,255,255,.5);
      font-size: .8rem; font-weight: 700;
      cursor: pointer; transition: all .14s;
      letter-spacing: .2px;
    }
    .tm-tab-btn:hover { background: rgba(255,255,255,.06); color: rgba(255,255,255,.8); }
    .tm-tab-btn.active {
      background: var(--accent,#f5c400);
      border-color: var(--accent,#f5c400);
      color: #08090d;
    }

    /* ‚îÄ‚îÄ Team matches list ‚îÄ‚îÄ */
    .tm-match-row {
      display: flex; align-items: flex-start; gap: 10px;
      padding: 10px 0;
      border-bottom: 1px solid rgba(255,255,255,.05);
    }
    .tm-match-row:last-child { border-bottom: none; }
    .tm-match-left {
      display: flex; flex-direction: column; align-items: center;
      gap: 4px; flex-shrink: 0; padding-top: 2px;
    }
    .tm-match-center { flex: 1; min-width: 0; }
    .tm-match-opp {
      display: flex; align-items: center; gap: 6px;
      margin-bottom: 3px;
    }
    .tm-opp-name { font-weight: 600; font-size: .88rem; }
    .tm-match-score-line {
      display: flex; align-items: center; gap: 8px;
    }
    .tm-score {
      font-size: 1rem; font-weight: 900;
      color: var(--accent,#f5c400);
    }
    .tm-match-type {
      font-size: .72rem; font-weight: 600;
      opacity: .45; text-transform: uppercase;
      letter-spacing: .05em;
    }
    .tm-match-scorers {
      display: flex; flex-wrap: wrap; gap: 5px;
      margin-top: 5px;
    }
    .tm-match-scorer {
      font-size: .75rem;
      background: rgba(255,255,255,.07);
      padding: 2px 8px; border-radius: 10px;
      opacity: .8;
    }

    /* result badge */
    .tm-res {
      font-size: .68rem; font-weight: 900;
      padding: 3px 6px; border-radius: 5px;
      letter-spacing: .05em;
      flex-shrink: 0;
    }
    .tm-res.win  { background: rgba(34,197,94,.15);  color: #22c55e; }
    .tm-res.draw { background: rgba(245,196,0,.12);  color: #f5c400; }
    .tm-res.loss { background: rgba(239,68,68,.12);  color: #ef4444; }
    .tm-res.tp   { background: rgba(239,68,68,.18);  color: #ef4444; letter-spacing: 0; }

    /* Home/Away pill */
    .tm-ha {
      font-size: .68rem; font-weight: 800;
      padding: 2px 5px; border-radius: 4px;
      letter-spacing: .05em; flex-shrink: 0;
    }
    .tm-ha.home { background: rgba(245,196,0,.12); color: var(--accent,#f5c400); }
    .tm-ha.away { background: rgba(255,255,255,.07); color: rgba(255,255,255,.5); }

    /* ‚îÄ‚îÄ Player expand / detail box ‚îÄ‚îÄ */
    .player-item-wrap { margin-bottom: 5px; }
    .player-item {
      display: flex; align-items: center; gap: 10px;
      padding: 9px 12px;
      border-radius: 9px;
      background: rgba(255,255,255,.04);
      transition: background .12s;
    }
    .player-item:hover { background: rgba(255,255,255,.07); }
    .player-item.expanded {
      background: rgba(255,255,255,.07);
      border-radius: 9px 9px 0 0;
    }

    .player-chevron {
      font-size: .7rem; opacity: .4;
      margin-left: auto; flex-shrink: 0;
      transition: transform .15s;
    }
    .player-chevron.open { opacity: .7; }

    .player-stat-badge {
      padding: 2px 9px; border-radius: 12px;
      font-size: .74rem; font-weight: 700;
    }
    .player-stat-badge.goal        { background: var(--accent,#f5c400); color: #08090d; }
    .player-stat-badge.goal.zero   { background: rgba(255,255,255,.10); color: rgba(255,255,255,.6); }
    .player-stat-badge.assist      { background: rgba(255,255,255,.12); color: rgba(255,255,255,.7); }

    /* Player detail expanded box */
    .player-detail-box {
      background: rgba(255,255,255,.025);
      border: 1px solid rgba(255,255,255,.07);
      border-top: none;
      border-radius: 0 0 9px 9px;
      padding: 10px 12px 12px;
    }
    .pd-summary {
      display: flex; flex-wrap: wrap; gap: 6px; align-items: center;
      margin-bottom: 10px;
      font-size: .78rem; opacity: .6;
    }
    .pd-stat { font-weight: 600; }
    .pd-sep { opacity: .4; }

    /* Per-match goal rows inside player detail */
    .pr-match-row {
      display: flex; align-items: center; gap: 7px;
      padding: 6px 0;
      border-bottom: 1px solid rgba(255,255,255,.04);
      flex-wrap: wrap;
    }
    .pr-match-row:last-child { border-bottom: none; }
    .pr-res {
      font-size: .65rem; font-weight: 900;
      padding: 2px 5px; border-radius: 4px;
      flex-shrink: 0;
    }
    .pr-res.win  { background: rgba(34,197,94,.15);  color: #22c55e; }
    .pr-res.draw { background: rgba(245,196,0,.12);  color: #f5c400; }
    .pr-res.loss { background: rgba(239,68,68,.12);  color: #ef4444; }
    .pr-opp   { font-weight: 600; font-size: .82rem; flex: 1; min-width: 80px; }
    .pr-score { font-weight: 800; font-size: .85rem; color: var(--accent,#f5c400); flex-shrink: 0; }
    .pr-type  { font-size: .7rem; opacity: .4; flex-shrink: 0; }
    .pr-goals { display: flex; flex-wrap: wrap; gap: 4px; width: 100%; margin-top: 3px; }
    .pr-goal-event {
      display: inline-flex; align-items: center; gap: 3px;
      font-size: .75rem;
      background: rgba(245,196,0,.1);
      border: 1px solid rgba(245,196,0,.2);
      border-radius: 10px; padding: 2px 8px;
      color: var(--accent,#f5c400);
    }
    .pr-min    { opacity: .6; font-size: .7rem; }
    .pr-assist { opacity: .55; font-size: .72rem; }

    /* ‚îÄ‚îÄ Technical Defeat (–¢–ü) ‚îÄ‚îÄ */
    /* Match card badge */
    .match-tp-badge {
      display:inline-block;
      font-size:.65rem;font-weight:800;letter-spacing:.04em;
      padding:2px 6px;border-radius:6px;
      background:rgba(239,68,68,.18);color:#ef4444;
      border:1px solid rgba(239,68,68,.35);
      margin-left:4px;vertical-align:middle;
    }
    /* Match card tinted border */
    .match-card.tp { border-left-color:#ef4444 !important; }

    /* Admin modal toggle row */
    .tp-toggle-row {
      display:flex;justify-content:center;
      margin-bottom:10px;
    }
    .tp-toggle-label {
      display:inline-flex;align-items:center;gap:8px;
      padding:8px 14px;border-radius:10px;cursor:pointer;
      background:rgba(239,68,68,.08);
      border:1px solid rgba(239,68,68,.2);
      font-size:.85rem;font-weight:600;color:rgba(255,255,255,.8);
      transition:all .15s;user-select:none;
    }
    .tp-toggle-label:hover { background:rgba(239,68,68,.14);border-color:rgba(239,68,68,.4); }
    .tp-toggle-label input { accent-color:#ef4444;width:15px;height:15px; }
    .tp-toggle-text { color:#ef4444; }

    /* TP loser row */
    .tp-loser-row {
      display:flex;align-items:center;gap:10px;
      margin:0 0 12px;padding:10px 14px;
      background:rgba(239,68,68,.06);
      border:1px solid rgba(239,68,68,.2);
      border-radius:10px;
    }
    .tp-loser-label { font-size:.82rem;font-weight:600;color:rgba(255,255,255,.7);white-space:nowrap; }

    /* Non-admin view banner */
    .view-tp-banner {
      text-align:center;
      padding:10px 16px;margin-bottom:12px;
      background:rgba(239,68,68,.1);
      border:1px solid rgba(239,68,68,.25);
      border-radius:10px;
      font-size:.85rem;font-weight:700;color:#ef4444;
      letter-spacing:.03em;
    }
  </style>
</head>
<body>

  <!-- Loading overlay -->
  <div id="loading" class="loading-overlay">
    <div class="loading-spinner"></div>
    <p>–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</p>
  </div>

  <div class="app" id="app" style="display:none">

    <!-- Header -->
    <header class="header">
      <div class="header-content">
        <div class="logo">
          <img src="assets/nml-logo.png" alt="NML" class="logo-icon">
          <div class="logo-text">
            <h1>NIS Media League</h1>
            <p>–®–∫–æ–ª—å–Ω–∞—è —Ñ—É—Ç–±–æ–ª—å–Ω–∞—è –ª–∏–≥–∞ &bull; –°–µ–∑–æ–Ω 2025/26</p>
          </div>
        </div>
        <div class="admin-access">
          <span id="adminBadge" class="admin-badge" hidden>ADMIN</span>
          <div id="codeBox" class="code-box" hidden>
            <input type="password" id="adminCode" placeholder="–ö–æ–¥ –¥–æ—Å—Ç—É–ø–∞" autocomplete="off">
          </div>
          <button id="lockBtn" class="lock-btn" title="–í—Ö–æ–¥ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞">üîí</button>
        </div>
      </div>
    </header>

    <!-- Stats bar -->
    <div class="stats-bar">
      <div class="stat-card">
        <span class="stat-value" id="statTeams">16</span>
        <span class="stat-label">–ö–æ–º–∞–Ω–¥</span>
      </div>
      <div class="stat-card">
        <span class="stat-value" id="statPlayed">0</span>
        <span class="stat-label">–ú–∞—Ç—á–µ–π —Å—ã–≥—Ä–∞–Ω–æ</span>
      </div>
      <div class="stat-card">
        <span class="stat-value" id="statGoals">0</span>
        <span class="stat-label">–ì–æ–ª–æ–≤ –∑–∞–±–∏—Ç–æ</span>
      </div>
      <div class="stat-card">
        <span class="stat-value" id="statRemaining">64</span>
        <span class="stat-label">–ú–∞—Ç—á–µ–π –æ—Å—Ç–∞–ª–æ—Å—å</span>
      </div>
    </div>

    <!-- Navigation -->
    <nav class="nav">
      <button class="nav-btn active" data-tab="table">–¢–∞–±–ª–∏—Ü–∞</button>
      <button class="nav-btn" data-tab="matches">–ú–∞—Ç—á–∏</button>
      <button class="nav-btn" data-tab="players">–ò–≥—Ä–æ–∫–∏</button>
      <button class="nav-btn" data-tab="playoff">–ü–ª–µ–π-–æ—Ñ—Ñ</button>
      <button class="nav-btn" data-tab="admin">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</button>
    </nav>

    <!-- Tabs -->
    <div class="tab-content">

      <!-- League Table -->
      <section id="tab-table" class="tab active">
        <div class="zone-legend">
          <span class="zone-badge zone-playoff">–ü–ª–µ–π-–æ—Ñ—Ñ (1-6)</span>
          <span class="zone-badge zone-qual">–°—Ç—ã–∫–æ–≤—ã–µ (7-10)</span>
          <span class="zone-badge zone-out">–í–Ω–µ –∑–æ–Ω—ã (11-16)</span>
        </div>
        <div class="table-wrapper">
          <table class="league-table">
            <thead>
              <tr>
                <th class="col-pos">#</th>
                <th class="col-team">–ö–æ–º–∞–Ω–¥–∞</th>
                <th>P</th><th>W</th><th>D</th><th>L</th>
                <th>GS</th><th>GC</th><th>GD</th>
                <th class="col-pts">Pts</th>
              </tr>
            </thead>
            <tbody id="tableBody"></tbody>
          </table>
        </div>
      </section>

      <!-- Matches -->
      <section id="tab-matches" class="tab">
        <div id="matchdays"></div>
      </section>

      <!-- Players / Scorers -->
      <section id="tab-players" class="tab">
        <div class="players-page">
          <div class="players-tab-header">
            <h2>‚öΩ –ò–≥—Ä–æ–∫–∏ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
            <select id="playerTeamFilter" class="team-filter-select" onchange="NML.filterPlayers(this.value)">
              <option value="">–í—Å–µ –∫–æ–º–∞–Ω–¥—ã</option>
            </select>
          </div>

          <!-- Static controls: never re-rendered, focus safe -->
          <div class="players-controls">
            <div class="sort-bar" id="sortBar">
              <span class="sort-label">–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞:</span>
              <button class="sort-chip active" data-sort="goals"   onclick="NML.setSort('goals')">‚öΩ –ì–æ–ª—ã</button>
              <button class="sort-chip"        data-sort="assists" onclick="NML.setSort('assists')">üëü –ê—Å—Å–∏—Å—Ç—ã</button>
              <button class="sort-chip"        data-sort="ga"      onclick="NML.setSort('ga')">üèÖ –ì–æ–ª—ã + –ê—Å—Å–∏—Å—Ç—ã</button>
            </div>
            <div class="player-search-wrap">
              <span class="search-icon">üîç</span>
              <input id="playerSearchInput" class="player-search-input" type="text"
                placeholder="–ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏ –∏–ª–∏ —Ñ–∞–º–∏–ª–∏–∏‚Ä¶"
                oninput="NML.searchPlayers(this.value)">
              <button class="search-clear" id="searchClearBtn"
                onclick="NML.searchPlayers('');document.getElementById('playerSearchInput').value='';this.style.display='none'"
                style="display:none" title="–û—á–∏—Å—Ç–∏—Ç—å">‚úï</button>
            </div>
          </div>

          <!-- Only the list is re-rendered -->
          <div id="playersList"></div>
        </div>
      </section>

      <!-- Playoff -->
      <section id="tab-playoff" class="tab">
        <div id="playoffContent"></div>
      </section>

      <!-- Admin -->
      <section id="tab-admin" class="tab">
        <div class="admin-grid">
          <div class="admin-card">
            <h3>–ù–∞–∑–≤–∞–Ω–∏—è –∏ –ª–æ–≥–æ—Ç–∏–ø—ã –∫–æ–º–∞–Ω–¥</h3>
            <p class="hint">–ö–ª–∏–∫–Ω–∏—Ç–µ –ø–æ –∏–∫–æ–Ω–∫–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –ª–æ–≥–æ—Ç–∏–ø–∞. –ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–º–µ–Ω–∏.</p>
            <div id="teamList" class="team-list"></div>
          </div>
          <div class="admin-card">
            <h3>–ñ–µ—Ä–µ–±—å—ë–≤–∫–∞</h3>
            <p class="hint">–û–¥–∏–Ω–∞–∫–æ–≤–æ–µ —á–∏—Å–ª–æ = –æ–¥–∏–Ω–∞–∫–æ–≤–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–±—Ä–æ—Å–∏—Ç –≤—Å–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.</p>
            <div class="seed-row">
              <input type="number" id="seedInput" placeholder="–ß–∏—Å–ª–æ –¥–ª—è –∂–µ—Ä–µ–±—å—ë–≤–∫–∏">
              <button id="generateBtn" class="btn-accent">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å</button>
            </div>
          </div>
          <div class="admin-card">
            <h3>–ò–º–ø–æ—Ä—Ç / –≠–∫—Å–ø–æ—Ä—Ç –º–∞—Ç—á–µ–π</h3>
            <p class="hint">–ó–∞–≥—Ä—É–∑–∏—Ç–µ JSON —Å –≥–æ—Ç–æ–≤—ã–º–∏ –º–∞—Ç—á–∞–º–∏ –∏–ª–∏ —Å–∫–∞—á–∞–π—Ç–µ —Ç–µ–∫—É—â–∏–µ.</p>
            <div class="import-export-row">
              <button id="exportMatchesBtn" class="btn-secondary">–°–∫–∞—á–∞—Ç—å –º–∞—Ç—á–∏</button>
              <label class="btn-accent file-label">–ó–∞–≥—Ä—É–∑–∏—Ç—å –º–∞—Ç—á–∏
                <input type="file" id="importMatchesFile" accept=".json" hidden>
              </label>
            </div>
          </div>
          <div class="admin-card">
            <h3>–î–æ–±–∞–≤–∏—Ç—å –º–∞—Ç—á –≤—Ä—É—á–Ω—É—é</h3>
            <select id="manualHome"></select>
            <input type="number" id="manualHomeGoals" min="0" placeholder="–ì–æ–ª—ã">
            <select id="manualAway"></select>
            <input type="number" id="manualAwayGoals" min="0" placeholder="–ì–æ–ª—ã">
            <button id="addMatchBtn" class="btn-accent">–î–æ–±–∞–≤–∏—Ç—å –º–∞—Ç—á</button>
          </div>
          <div class="admin-card">
            <h3>–ò–º–ø–æ—Ä—Ç / –≠–∫—Å–ø–æ—Ä—Ç —Ç–∞–±–ª–∏—Ü—ã</h3>
            <p class="hint">–ó–∞–≥—Ä—É–∑–∏—Ç–µ JSON —Å –≥–æ—Ç–æ–≤–æ–π —Ç–∞–±–ª–∏—Ü–µ–π –∏–ª–∏ —Å–∫–∞—á–∞–π—Ç–µ —Ç–µ–∫—É—â—É—é.</p>
            <div class="import-export-row">
              <button id="exportTableBtn" class="btn-secondary">–°–∫–∞—á–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É</button>
              <label class="btn-accent file-label">–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É
                <input type="file" id="importTableFile" accept=".json" hidden>
              </label>
            </div>
            <div id="customTableBadge" class="custom-table-badge" hidden>
              –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞
              <button id="clearCustomTable" class="btn-ghost btn-small">–°–±—Ä–æ—Å–∏—Ç—å</button>
            </div>
          </div>
          <div class="admin-card">
            <h3>–°–±—Ä–æ—Å –¥–∞–Ω–Ω—ã—Ö</h3>
            <p class="hint">–£–¥–∞–ª–∏—Ç –≤—Å–µ –º–∞—Ç—á–∏ –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã. –ö–æ–º–∞–Ω–¥—ã –æ—Å—Ç–∞–Ω—É—Ç—Å—è.</p>
            <button id="resetBtn" class="btn-danger">–°–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ –º–∞—Ç—á–∏</button>
          </div>
        </div>
      </section>

    </div>

    <footer class="footer">
      NML ‚Äî NIS Media League &bull; –î–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ Supabase
    </footer>
  </div>

  <!-- ===================== MATCH MODAL ===================== -->
  <!-- Content is rendered dynamically by app.js -->
  <div id="modal" class="modal-overlay" hidden>
    <div class="modal" id="modalInner" style="max-width:480px;width:95%"></div>
  </div>

  <!-- ===================== TEAM MODAL ===================== -->
  <div id="teamModal" class="modal-overlay-team" hidden>
    <div class="team-modal-box">
      <div class="team-modal-header">
        <div class="team-logo-wrap">
          <img id="tmLogoImg" class="team-logo-lg" hidden>
          <div id="tmLogoPlaceholder" class="logo-placeholder-lg">‚öΩ</div>
          <label class="logo-upload-btn" title="–ó–∞–≥—Ä—É–∑–∏—Ç—å –ª–æ–≥–æ—Ç–∏–ø">
            üì∑ –õ–æ–≥–æ
            <input type="file" id="tmLogoInput" accept="image/*" hidden>
          </label>
        </div>
        <div class="team-modal-info">
          <h3 id="tmTitle">–ö–æ–º–∞–Ω–¥–∞</h3>
          <p id="tmMeta" class="team-modal-meta"></p>
        </div>
        <button class="team-modal-close" onclick="NML.closeTeam()">‚úï</button>
      </div>
      <div class="team-modal-body">
        <!-- Add Player Form (admin only, always above tabs) -->
        <div id="addPlayerForm" class="add-player-form">
          <input id="apNum"       type="number" class="inp-num"  placeholder="#"       min="1" max="99">
          <input id="apLastName"  class="inp-name"               placeholder="–§–∞–º–∏–ª–∏—è">
          <input id="apFirstName" class="inp-name"               placeholder="–ò–º—è">
          <div class="form-btns">
            <button class="btn-sm-accent" onclick="NML.addPlayer()">‚úì –î–æ–±–∞–≤–∏—Ç—å</button>
            <button class="btn-sm-ghost"  onclick="NML.toggleAddPlayer()">–û—Ç–º–µ–Ω–∞</button>
          </div>
        </div>

        <!-- Tabs rendered dynamically by renderTeamModal() -->
        <div id="tmTabsBody"></div>
      </div>
    </div>
  </div>

  <!-- Toast -->
  <div id="toast" class="toast" hidden></div>

  <!-- Supabase JS v2 -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>
  <script src="app.js"></script>
</body>
</html>